<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Locations with Google Maps</title>
    <link href= "style.css"  rel="stylesheet" type="text/css" />
    <link href= "fileupload.css"  rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.12/lottie.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
    <div class="wrapper">
        <section id="formholder">
            <div class="secholder">
                <div data-multi-step class="multi-step-form">
                    <div class="progress-bar">
                        <div class="progress-bar-fill" style="width: 0;"></div>
                    </div>
                    <form  action="insert_job.php" method="post">
                        <div class="card active" data-step>
                            <div class="maphead">
                                <h3>Enter address</h3>
                            </div>
                            <div class="containerr">
        
                                <!--search input-->
                                <input type="text" id="searchInput" class="controls" placeholder="Enter location">
                        
                                <!--Google map-->
                                <div id="map"></div>
                        
                                <!--display geolocation data-->
                        
                                <ul>
                                    <li>Full Address:<span id="location"></span></li>
                                    <li>Postal Code:<span id="postal_code"></span></li>
                                    <li>Country:<span id="country"></span></li>
                                    <li>Latitude:<span id="lat"></span></li>
                                    <li>Longitude:<span id="lon"></span></li>
                                </ul>
                            </div> 
                        
                            <!--Google maps javascript API-->
                            <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCEriT4z_3CZYJU83eNKidV1K5aE1RP0mc&libraries=places&callback=initMap" async defer></script>
                        
                            <script>
                                function initMap() {
                                    var map = new google.maps.Map(document.getElementById('map'), {
                                        center: {lat: -33.8688, lng: 151.2195},
                                        zoom:13
                                    });
                        
                                    var input = document.getElementById('searchInput');
                                    map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);
                        
                                    var autocomplete = new google.maps.places.Autocomplete(input);
                                    autocomplete.bindTo('bounds', map);
                                    var infowindow = new google.maps.InfoWindow();
                                    var marker = new google.maps.Marker({
                                        map: map,
                                        anchorPoint: new google.maps.Point(0, -29)
                                    });
                        
                                    autocomplete.addListener('place_changed', function(){
                                        infowindow.close();
                                        marker.setVisible(false);
                                        var place = autocomplete.getPlace();
                                        if (!place.geometry) {
                                            window.alert("Autocomplete's returned place contains no geometry");
                                            return;
                                        }
                        
                                        if (place.geometry.viewport) {
                                            map.fitBounds(place.geometry.viewport);
                                        }else{
                                            map.setCenter(place.geometry.location);
                                            map.setZoom(17);
                                        }
                        
                                        if (place.icon) {
                                            marker.setIcon({
                                                url: place.icon,
                                                size: new google.maps.Size(71, 71),
                                                origin: new google.maps.Point(0, 0),
                                                anchor: new google.maps.Point(17, 34),
                                                scaledSize: new google.maps.Size(35, 35)
                                            });
                                        } else {
                                            marker.setIcon(null);
                                        }
                        
                                        marker.setPosition(place.geometry.location);
                                        marker.setVisible(true);
                        
                                        var address = '';
                                        if (place.address_components) {
                                            address = [
                                                (place.address_components[0] && place.address_components[0].short_name || ''),
                                                (place.address_components[1] && place.address_components[1].short_name || ''),
                                                (place.address_components[2] && place.address_components[2].short_name || '')
                                            ].join(' ');
                                        }
                        
                                        infowindow.setContent('<div><strong>' + place.name + '<strong><br>' + address);
                                        infowindow.open(map, marker);
                        
                                        //location details
                                        for (var i = 0; i < place.address_components.length; i++){
                                            if(place.address_components[i].types[0] =='postal_code'){
                                                document.getElementById('postal_code').innerHTML = place.address_components[i].long_name;
                                            }
                                            if(place.address_components[i].types[0] == 'country'){
                                                document.getElementById('country').innerHTML = place.address_components[i].long_name; 
                                            }
                                        }
                                        document.getElementById('location').innerHTML = place.formatted_address;
                                        document.getElementById('lat').innerHTML = place.geometry.location.lat();
                                        document.getElementById('lon').innerHTML = place.geometry.location.lng();
                                    });
                                }
                            </script>
                            <div class="groupholder">
                                
                        
                            <button type="button" class="prevbtn" data-previous>Previous</button>
                            <button type="button" class="nextbtn" data-next>Next</button>
                            </div>
                            
                        </div>
                        <div class="card" data-step>
                            <div class="alignhold">
                                <div class="groupholder">
                                    <h3 class="step-title">Enter Legal Credentials</h3>
                                   
                                        <div class="form-group">
                                            <label for="organization">Organization name<span>*</span></label><br>
                                            <input  type="text" name="organization" id="organization" required><br>
                                        </div>
                                        <div class="form-group">
                                            <label for="jobtitle">Job title<span>*</span></label><br>
                                            <input  type="text" name="jobtitle" id="jobtitle" required><br>
                                        </div>
                                        <div class="form-group">
                                            <div class="form-container">
                                                <div class="formgroupp">
                                                    <label for="job_type">Job Type*</label>
                                                    <select id="job_type" name="job_type">
                                                        <option value="" disabled selected>Select option</option>
                                                        <option value="full_time">Full Time</option>
                                                        <option value="partial">Partial</option>
                                                    </select>
                                                </div>
                                                <!-- Other form fields -->
                                            </div>
                                            
                                        </div>
                                       
        
                                
                                <button type="button" class="prevbtn" data-previous>Previous</button>
                                <button type="button" class="nextbtn" data-next>Next</button>
                                </div>
                            </div>
                        </div>
                        <div class="card" data-step>
                            <div class="alignhold">
                                <div class="groupholder">
                                    <h3 class="step-title">Enter Legal Credentials</h3>
                                    <div class="grouphold">
                                        <div class="salary">
                                            <label for="salaryInput">Enter Salary:<span id="averageSalary">$0</span></label><br>
                                            <input type="number" id="salaryInput" name="salary" placeholder="Enter salary amount">
                                        </div>
                                        
                                    </div>
                                    <div class="work">
                                        <label for="expected">What employee is expected to do</label>
                                        <textarea name="expected" id="expected" rows="5" placeholder="Employer is expected to ..."></textarea>
                                    </div>                               
                                <button type="button" class="prevbtn" data-previous>Previous</button>
                                <button type="submit" class="subbtn" data-submit>Submit</button>
                                </div>
                            </div>
                        </div>
                        
                        
                        <div class="card" data-step>
                            <div class="alignhold">
                                <div class="groupholder">
                                    <div class="animation-container">
                                        <div class="animation-lottie" id="animation"></div>
                                        <button class="btn" data-goto-home>Go to home page</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>                                     
    </div>    
        
    <script>
        const salaryInput = document.getElementById('salaryInput');
        const averageSalarySpan = document.getElementById('averageSalary');
        
        salaryInput.addEventListener('input', () => {
            const salary = parseFloat(salaryInput.value);
            if (!isNaN(salary)) {
                averageSalarySpan.textContent = '$' + salary.toFixed(2);
            } else {
                averageSalarySpan.textContent = '$0';
            }
        });
    </script>
        <script>
            function uploadFile() {
                var input = document.querySelector('.file-input');
                var file = input.files[0];
        
                if (file) {
                    var formData = new FormData();
                    formData.append('fileToUpload', file);
        
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', 'upload.php', true);
        
                    xhr.onload = function() {
                        // Add any logic after file upload completion if needed
                    };
        
                    xhr.send(formData);
                }
            }
        
            document.querySelector('.multi-step-form').addEventListener('submit', function(event) {
                event.preventDefault(); // Prevent the default form submission
                // Your logic for submitting the form here
            });
        
            // Add your logic for moving between steps here
        </script>
        
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const multiStepForm = document.querySelector("[data-multi-step]");
                const formSteps = [...multiStepForm.querySelectorAll("[data-step]")];
                let currentStep = formSteps.findIndex(step => step.classList.contains("active"));
                const totalSteps = 4;
            
                function updateProgressBar() {
                    const progress = Math.min(((currentStep + 1) / totalSteps) * 100, 100);
                    document.querySelector('.progress-bar-fill').style.width = `${progress}%`;
                }
            
                updateProgressBar();
            
                multiStepForm.addEventListener("click", e => {
                    let incrementor;
                    if (e.target.matches("[data-next]")) {
                        incrementor = 1;
                    } else if (e.target.matches("[data-previous]")) {
                        incrementor = -1;
                    }
                    if (incrementor == null) return;
            
                    const inputs = [...formSteps[currentStep].querySelectorAll("input")];
                    const allValid = inputs.every(input => input.reportValidity());
                    if (allValid) {
                        currentStep += incrementor;
                        showCurrentStep();
                        updateProgressBar();
                    }
                });
            
                function showCurrentStep() {
                    formSteps.forEach((step, index) => {
                        step.classList.toggle("active", index === currentStep);
                    });
                }
            
                multiStepForm.addEventListener("submit", e => {
                    e.preventDefault();
                    currentStep = totalSteps - 1;
                    showCurrentStep();
                    updateProgressBar();
                    const form = e.target;
                    const formData = new FormData(form);
                    const xhr = new XMLHttpRequest();
                    xhr.open('POST', form.action, true);
                    xhr.onload = function() {
                        console.log(xhr.responseText);
                        playAnimation();
                    };
                    xhr.send(formData);
                });
            
                function playAnimation() {
                    const animationContainer = document.getElementById("animation");
                    const animationData = {
                        container: animationContainer,
                        renderer: "svg",
                        loop: false,
                        autoplay: true,
                        path: "Animation - 1707839206238.json",
                    };
                    lottie.loadAnimation(animationData);
                }
            
                const goToHomeButton = document.querySelector(".btn");
                goToHomeButton.addEventListener("click", (e) => {
                    e.preventDefault(); // Prevent default form submission behavior
                    window.location.href = "home.html";
                });
            });
            
            </script>
            
<script type="module" src="fileupload.js"></script>
<script type="module" src="map.js"></script>
</body>
</html>


